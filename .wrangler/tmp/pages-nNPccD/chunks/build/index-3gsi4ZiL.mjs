import{W as e}from"../runtime.mjs";import{g as a,d as t,e as s,f as n}from"./server.mjs";import{_ as r}from"./_plugin-vue_export-helper-1tPrXgE0.mjs";import{j as o,d as l,M as d,N as c,I as i,u,O as p,P as m,r as v,Q as f,t as g,c as y,R as h,b as _,s as b,z as D,g as x,J as w}from"../routes/renderer.mjs";function useRequestFetch(){var e;return(null==(e=function(e=t()){var a;return null==(a=e.ssrContext)?void 0:a.event}())?void 0:e.$fetch)||globalThis.$fetch}const isDefer=e=>"defer"===e||!1===e;function useAsyncData(...e){var a,r,o,l,d,c,i,p,m;const f="string"==typeof e[e.length-1]?e.pop():void 0;"string"!=typeof e[0]&&e.unshift(f);let[g,y,h={}]=e;if("string"!=typeof g)throw new TypeError("[nuxt] [asyncData] key must be a string.");if("function"!=typeof y)throw new TypeError("[nuxt] [asyncData] handler must be a function.");const _=t(),P=y;h.server=null==(a=h.server)||a,h.default=null!=(r=h.default)?r:()=>s.value,h.getCachedData=null!=(o=h.getCachedData)?o:()=>_.isHydrating?_.payload.data[g]:_.static.data[g],h.lazy=null!=(l=h.lazy)&&l,h.immediate=null==(d=h.immediate)||d,h.deep=null!=(c=h.deep)?c:s.deep,h.dedupe=null!=(i=h.dedupe)?i:"cancel";const hasCachedData=()=>null!=h.getCachedData(g,_);if(!_._asyncData[g]||!h.immediate){null!=(m=_.payload._errors)[g]||(m[g]=s.errorValue);const e=h.deep?v:b;_._asyncData[g]={data:e(null!=(p=h.getCachedData(g,_))?p:h.default()),pending:v(!hasCachedData()),error:D(_.payload._errors,g),status:v("idle"),_default:h.default}}const $={..._._asyncData[g]};delete $._default,$.refresh=$.execute=(e={})=>{var a;if(_._asyncDataPromises[g]){if(isDefer(null!=(a=e.dedupe)?a:h.dedupe))return _._asyncDataPromises[g];_._asyncDataPromises[g].cancelled=!0}if((e._initial||_.isHydrating&&!1!==e._initial)&&hasCachedData())return Promise.resolve(h.getCachedData(g,_));$.pending.value=!0,$.status.value="pending";const t=new Promise(((e,a)=>{try{e(P(_))}catch(e){a(e)}})).then((async e=>{if(t.cancelled)return _._asyncDataPromises[g];let a=e;h.transform&&(a=await h.transform(e)),h.pick&&(a=function(e,a){const t={};for(const s of a)t[s]=e[s];return t}(a,h.pick)),_.payload.data[g]=a,$.data.value=a,$.error.value=s.errorValue,$.status.value="success"})).catch((e=>{if(t.cancelled)return _._asyncDataPromises[g];$.error.value=n(e),$.data.value=u(h.default()),$.status.value="error"})).finally((()=>{t.cancelled||($.pending.value=!1,delete _._asyncDataPromises[g])}));return _._asyncDataPromises[g]=t,_._asyncDataPromises[g]},$.clear=()=>function(e,a){a in e.payload.data&&(e.payload.data[a]=void 0);a in e.payload._errors&&(e.payload._errors[a]=s.errorValue);e._asyncData[a]&&(e._asyncData[a].data.value=e._asyncData[a]._default(),e._asyncData[a].error.value=s.errorValue,e._asyncData[a].pending.value=!1,e._asyncData[a].status.value="idle");a in e._asyncDataPromises&&(e._asyncDataPromises[a].cancelled=!0,e._asyncDataPromises[a]=void 0)}(_,g);if(!1!==h.server&&_.payload.serverRendered&&h.immediate){const e=$.refresh({_initial:!0});x()?w((()=>e)):_.hook("app:created",(async()=>{await e}))}const R=Promise.resolve(_._asyncDataPromises[g]).then((()=>$));return Object.assign(R,$),R}function useFetch(t,s,n){const[r={},o]="string"==typeof s?[{},s]:[s,n],l=y((()=>h(t))),d=r.key||e([o,"string"==typeof l.value?l.value:"",...generateOptionSegments(r)]);if(!d||"string"!=typeof d)throw new TypeError("[nuxt] [useFetch] key must be a string: "+d);if(!t)throw new Error("[nuxt] [useFetch] request is missing.");const c=d===o?"$f"+d:d;if(!r.baseURL&&"string"==typeof l.value&&"/"===l.value[0]&&"/"===l.value[1])throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:i,lazy:u,default:p,transform:m,pick:v,watch:f,immediate:g,getCachedData:b,deep:D,dedupe:x,...w}=r,P=_({...a,...w,cache:"boolean"==typeof r.cache?void 0:r.cache});let $;return useAsyncData(c,(()=>{var e;null==(e=null==$?void 0:$.abort)||e.call($),$="undefined"!=typeof AbortController?new AbortController:{};const a=h(r.timeout);let t;a&&(t=setTimeout((()=>$.abort()),a),$.signal.onabort=()=>clearTimeout(t));let s=r.$fetch||globalThis.$fetch;if(!r.$fetch){"string"==typeof l.value&&"/"===l.value[0]&&(!h(r.baseURL)||"/"===h(r.baseURL)[0])&&(s=useRequestFetch())}return s(l.value,{signal:$.signal,...P}).finally((()=>{clearTimeout(t)}))}),{server:i,lazy:u,default:p,transform:m,pick:v,immediate:g,getCachedData:b,deep:D,dedupe:x,watch:!1===f?[]:[P,l,...f||[]]})}function generateOptionSegments(e){var a;const t=[(null==(a=h(e.method))?void 0:a.toUpperCase())||"GET",h(e.baseURL)];for(const a of[e.params||e.query]){const e=h(a);if(!e)continue;const s={};for(const[a,t]of Object.entries(e))s[h(a)]=h(t);t.push(s)}return t}const P=l({__name:"ImageGallery",__ssrInlineRender:!0,async setup(e){let a,t;const{data:s,refresh:n}=([a,t]=d((()=>useFetch("/api/images","$Nxggt4fPsR"))),a=await a,t(),a);return(e,a,t,n)=>{var r,o;a(`<div${c(i({class:"image-uploader"},n))} data-v-57088523><h3 data-v-57088523>Images</h3><form class="upload-form" data-v-57088523><label class="upload-label" data-v-57088523>Upload an image: <input type="file" name="image" accept="image/jpg,image/png" class="upload-input" data-v-57088523></label><button type="submit" class="upload-button" data-v-57088523>Upload</button></form><div class="images-container" data-v-57088523>`),(null==(r=u(s))?void 0:r.length)?(a("<p data-v-57088523>\x3c!--[--\x3e"),p(u(s),(e=>{a(`<img width="200"${f("src",`/images/${e.pathname}`)}${f("alt",e.pathname)} class="uploaded-image" data-v-57088523>`)})),a("\x3c!--]--\x3e</p>")):a("\x3c!----\x3e"),(null==(o=u(s))?void 0:o.length)?a("<p data-v-57088523><i data-v-57088523>Tip: delete an image by double-clicking on it.</i></p>"):a("\x3c!----\x3e"),a("</div></div>")}}}),$=P.setup;P.setup=(e,a)=>{const t=o();return(t.modules||(t.modules=new Set)).add("components/ImageGallery.vue"),$?$(e,a):void 0};const R=r(P,[["__scopeId","data-v-57088523"]]),C=l({__name:"RedirectsPanel",__ssrInlineRender:!0,async setup(e){let a,t;const{data:s,refresh:n}=([a,t]=d((()=>useFetch("/api/redirects",{transform:e=>Object.entries(e).map((([e,a])=>`${e} ${a}`)).join("\n")},"$qudnCtMtUq"))),a=await a,t(),a);return(e,a,t,n)=>{a(`<div${c(i({class:"redirect-container"},n))} data-v-a7d0d628><h3 data-v-a7d0d628>Server redirects</h3><form class="redirect-form" data-v-a7d0d628><p data-v-a7d0d628><textarea rows="6" placeholder="/from /to (one redirect per line)" class="redirect-textarea" data-v-a7d0d628>${m(u(s))}</textarea></p><button type="submit" class="save-button" data-v-a7d0d628>Save redirects</button></form></div>`)}}}),j=C.setup;C.setup=(e,a)=>{const t=o();return(t.modules||(t.modules=new Set)).add("components/RedirectsPanel.vue"),j?j(e,a):void 0};const T=r(C,[["__scopeId","data-v-a7d0d628"]]),F=l({__name:"MessagesPanel",__ssrInlineRender:!0,async setup(e){let a,t;const{data:s,refresh:n}=([a,t]=d((()=>useFetch("/api/messages","$0AMhPWytjY"))),a=await a,t(),a),r=v("");return(e,a,t,n)=>{var o;a(`<div${c(i({class:"message-container"},n))} data-v-d98c083c><h3 data-v-d98c083c>Messages</h3><form class="message-form" data-v-d98c083c><input${f("value",u(r))} placeholder="Type a message" class="message-input" data-v-d98c083c><button type="submit" class="send-button" data-v-d98c083c>Send</button></form><div class="messages-list" data-v-d98c083c>\x3c!--[--\x3e`),p(u(s),(e=>{a(`<p class="message-item" data-v-d98c083c>${m(e.text)} - ${m(e.created_at?new Date(e.created_at).toLocaleString("fr-FR"):"")}</p>`)})),a("\x3c!--]--\x3e"),(null==(o=u(s))?void 0:o.length)?a("\x3c!----\x3e"):a('<p class="no-messages" data-v-d98c083c> No messages yet </p>'),a("</div></div>")}}}),I=F.setup;F.setup=(e,a)=>{const t=o();return(t.modules||(t.modules=new Set)).add("components/MessagesPanel.vue"),I?I(e,a):void 0};const S=r(F,[["__scopeId","data-v-d98c083c"]]),k={};const U=k.setup;k.setup=(e,a)=>{const t=o();return(t.modules||(t.modules=new Set)).add("pages/index.vue"),U?U(e,a):void 0};const q=r(k,[["ssrRender",function(e,a,t,s){const n=R,r=T,o=S;a(`<main${c(s)}>`),a(g(n,null,null,t)),a(g(r,null,null,t)),a(g(o,null,null,t)),a("</main>")}]]);export{q as default};
//# sourceMappingURL=index-3gsi4ZiL.mjs.map
